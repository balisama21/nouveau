<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Digital-Marketing - Produits Numériques Madagascar</title>
    <style>
        /* Import Google Fonts pour une typo moderne */
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap');
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, #f8fafc 0%, #f1f5f9 100%);
            color: #1e293b;
            overflow-x: hidden;
            line-height: 1.6;
            width: 100%;
            max-width: 100vw;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            max-width: 100%;
        }

        /* En-tête amélioré */
        .header {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(20px);
            border-bottom: 1px solid rgba(226, 232, 240, 0.5);
            padding: 16px 24px;
            position: sticky;
            top: 0;
            z-index: 1000;
            box-shadow: 0 4px 24px rgba(0, 0, 0, 0.04);
        }

        .header-container {
            max-width: 1400px;
            margin: 0 auto;
            display: flex;
            align-items: center;
            justify-content: space-between;
            gap: 16px;
            width: 100%;
        }

        .header-top {
            display: contents; /* Sur desktop, pas de conteneur séparé */
        }

        .logo {
            font-size: 24px;
            font-weight: 700;
            background: linear-gradient(135deg, #059669, #dc2626);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            cursor: pointer;
            transition: all 0.3s ease;
            letter-spacing: -0.5px;
            flex-shrink: 0;
            min-width: fit-content;
        }

        .logo:hover {
            transform: scale(1.05);
        }

        .search-container {
            flex: 1;
            max-width: 500px;
            margin: 0 16px;
            position: relative;
            min-width: 200px;
        }

        .search-bar {
            width: 100%;
            padding: 16px 56px 16px 20px;
            border: 2px solid #e2e8f0;
            border-radius: 16px;
            font-size: 16px;
            outline: none;
            transition: all 0.3s ease;
            background: rgba(255, 255, 255, 0.8);
            font-weight: 400;
        }

        .search-bar:focus {
            border-color: #059669;
            box-shadow: 0 0 0 4px rgba(5, 150, 105, 0.1);
            background: white;
        }

        .search-btn {
            position: absolute;
            right: 8px;
            top: 50%;
            transform: translateY(-50%);
            background: linear-gradient(135deg, #059669, #047857);
            border: none;
            width: 44px;
            height: 44px;
            border-radius: 12px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            transition: all 0.3s ease;
            font-size: 16px;
        }

        .search-btn:hover {
            transform: translateY(-50%) scale(1.05);
            box-shadow: 0 8px 24px rgba(5, 150, 105, 0.3);
        }

        .header-actions {
            display: flex;
            align-items: center;
            gap: 8px;
            flex-shrink: 0;
        }

        .btn-header {
            padding: 8px 12px;
            border: 2px solid #e2e8f0;
            background: rgba(255, 255, 255, 0.8);
            color: #475569;
            border-radius: 10px;
            text-decoration: none;
            font-weight: 500;
            transition: all 0.3s ease;
            font-size: 13px;
            backdrop-filter: blur(10px);
            white-space: nowrap;
        }

        .btn-header:hover {
            background: #059669;
            color: white;
            border-color: #059669;
            transform: translateY(-2px);
            box-shadow: 0 8px 24px rgba(5, 150, 105, 0.25);
        }
        
        .btn-sell {
            background: linear-gradient(135deg, #3b82f6, #2563eb);
            color: white;
            border-color: #3b82f6;
        }

        .btn-sell:hover {
            background: linear-gradient(135deg, #2563eb, #1d4ed8);
            box-shadow: 0 8px 24px rgba(59, 130, 246, 0.3);
        }

        /* Bouton compte combiné */
        .auth-btn {
            background: linear-gradient(135deg, #059669, #047857);
            color: white;
            border: none;
            padding: 8px 12px;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 13px;
            font-weight: 500;
            display: flex;
            align-items: center;
            gap: 6px;
            white-space: nowrap;
        }

        .auth-btn:hover {
            background: linear-gradient(135deg, #047857, #065f46);
            transform: translateY(-2px);
            box-shadow: 0 8px 24px rgba(5, 150, 105, 0.3);
        }

        .flag-mg, .cart-icon {
            width: 32px;
            height: 32px;
            border-radius: 8px;
            background: #f1f5f9;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 16px;
            flex-shrink: 0;
        }

        .flag-mg {
            background-image: url('https://flagcdn.com/32x24/mg.png');
            background-size: cover;
            background-position: center;
        }

        .flag-mg:hover, .cart-icon:hover {
            transform: scale(1.1);
            box-shadow: 0 4px 16px rgba(0, 0, 0, 0.1);
        }

        /* Menu Mobile Amélioré */
        .mobile-menu {
            display: none;
            flex-direction: column;
            cursor: pointer;
            padding: 6px;
            border-radius: 6px;
            transition: all 0.3s ease;
            gap: 3px;
        }

        .mobile-menu:hover {
            background-color: #f1f5f9;
        }

        .mobile-menu span {
            width: 20px;
            height: 2px;
            background: #475569;
            border-radius: 2px;
            transition: all 0.3s ease;
        }

        .mobile-menu.active span:nth-child(1) {
            transform: rotate(45deg) translate(8px, 8px);
        }

        .mobile-menu.active span:nth-child(2) {
            opacity: 0;
        }

        .mobile-menu.active span:nth-child(3) {
            transform: rotate(-45deg) translate(7px, -6px);
        }

        /* Navigation horizontale centrée */
        .nav {
            background: rgba(255, 255, 255, 0.9);
            backdrop-filter: blur(10px);
            border-bottom: 1px solid rgba(226, 232, 240, 0.5);
            padding: 0 24px;
        }

        .nav-container {
            max-width: 1400px;
            margin: 0 auto;
            display: flex;
            justify-content: center;
            gap: 48px;
            padding: 20px 0;
        }

        .nav-link {
            text-decoration: none;
            color: #64748b;
            font-weight: 500;
            padding: 12px 0;
            border-bottom: 2px solid transparent;
            transition: all 0.3s ease;
            position: relative;
            cursor: pointer;
            font-size: 15px;
        }

        .nav-link:hover, .nav-link.active {
            color: #059669;
        }

        .nav-link::after {
            content: '';
            position: absolute;
            width: 0;
            height: 2px;
            bottom: -2px;
            left: 50%;
            background: linear-gradient(135deg, #059669, #dc2626);
            transition: all 0.3s ease;
            transform: translateX(-50%);
            border-radius: 1px;
        }

        .nav-link:hover::after, .nav-link.active::after {
            width: 100%;
        }

        /* Navigation Mobile Améliorée */
        .mobile-nav {
            display: none;
            position: fixed;
            top: 0;
            right: -100%;
            width: 80%;
            max-width: 400px;
            height: 100vh;
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(20px);
            z-index: 2000;
            transition: right 0.4s cubic-bezier(0.25, 0.46, 0.45, 0.94);
            padding: 80px 0 40px;
            overflow-y: auto;
            box-shadow: -8px 0 32px rgba(0, 0, 0, 0.1);
        }

        .mobile-nav.active {
            right: 0;
        }

        .mobile-nav-container {
            padding: 0 24px;
            display: flex;
            flex-direction: column;
            gap: 8px;
        }

        .mobile-nav-link {
            display: flex;
            align-items: center;
            color: #475569;
            text-decoration: none;
            font-size: 16px;
            font-weight: 500;
            padding: 16px 20px;
            margin: 4px 0;
            border-radius: 12px;
            transition: all 0.3s ease;
            background: rgba(248, 250, 252, 0.5);
            cursor: pointer;
            gap: 12px;
        }

        .mobile-nav-link:hover {
            background: rgba(5, 150, 105, 0.1);
            color: #059669;
            transform: translateX(8px);
        }

        .mobile-nav-close {
            position: absolute;
            top: 24px;
            right: 24px;
            color: #64748b;
            font-size: 24px;
            cursor: pointer;
            width: 40px;
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 10px;
            background: rgba(248, 250, 252, 0.8);
            transition: all 0.3s ease;
        }

        .mobile-nav-close:hover {
            background: rgba(239, 68, 68, 0.1);
            color: #dc2626;
            transform: rotate(90deg);
        }

        /* Contenu Principal */
        .main {
            max-width: 1400px;
            margin: 0 auto;
            padding: 40px 24px;
        }

        .main > section {
            display: none;
        }
        
        .main > section.active {
            display: block;
        }

        .hero-section {
            text-align: center;
            margin-bottom: 48px;
            padding: 32px 0;
        }

        .hero-title {
            font-size: 42px;
            font-weight: 700;
            color: #1e293b;
            margin-bottom: 16px;
            letter-spacing: -1px;
            line-height: 1.2;
        }

        .hero-subtitle {
            color: #64748b;
            font-size: 18px;
            margin-bottom: 32px;
            font-weight: 400;
        }

        /* Résultats de recherche */
        .search-results {
            background: linear-gradient(135deg, rgba(5, 150, 105, 0.05), rgba(5, 150, 105, 0.1));
            border: 1px solid rgba(5, 150, 105, 0.2);
            border-radius: 16px;
            padding: 20px 24px;
            margin-bottom: 24px;
            display: none;
        }

        .search-results.active {
            display: block;
        }

        .search-results-text {
            color: #059669;
            font-weight: 600;
            margin-bottom: 8px;
            font-size: 16px;
        }

        .search-results-count {
            color: #64748b;
            font-size: 14px;
        }

        .no-results {
            background: linear-gradient(135deg, rgba(239, 68, 68, 0.05), rgba(239, 68, 68, 0.1));
            border: 1px solid rgba(239, 68, 68, 0.2);
            border-radius: 16px;
            padding: 48px;
            text-align: center;
            display: none;
        }

        .no-results.active {
            display: block;
        }

        .no-results-icon {
            font-size: 64px;
            margin-bottom: 20px;
            opacity: 0.6;
        }

        .no-results-title {
            color: #dc2626;
            font-size: 24px;
            font-weight: 600;
            margin-bottom: 12px;
        }

        .no-results-text {
            color: #64748b;
            margin-bottom: 24px;
            font-size: 16px;
        }

        .clear-search-btn {
            background: linear-gradient(135deg, #dc2626, #b91c1c);
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 12px;
            cursor: pointer;
            font-weight: 500;
            transition: all 0.3s ease;
        }

        .clear-search-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 24px rgba(220, 38, 38, 0.3);
        }

        /* Filtres améliorés */
        .filters {
            display: none;
            flex-wrap: wrap;
            gap: 12px;
            margin-bottom: 48px;
            align-items: center;
            justify-content: center;
            padding: 24px;
            background: rgba(255, 255, 255, 0.6);
            border-radius: 20px;
            backdrop-filter: blur(10px);
        }

        .filters.active {
            display: flex;
        }

        .filter-btn {
            padding: 12px 20px;
            border: 2px solid #e2e8f0;
            background: rgba(255, 255, 255, 0.8);
            border-radius: 16px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 14px;
            font-weight: 500;
            color: #475569;
            backdrop-filter: blur(10px);
        }

        .filter-btn:hover, .filter-btn.active {
            background: #059669;
            color: white;
            border-color: #059669;
            transform: translateY(-2px);
            box-shadow: 0 8px 24px rgba(5, 150, 105, 0.25);
        }

        .filter-btn.top-seller {
            background: linear-gradient(135deg, #f59e0b, #d97706);
            color: white;
            border-color: #f59e0b;
        }

        .filter-btn.top-seller:hover {
            background: linear-gradient(135deg, #d97706, #b45309);
            box-shadow: 0 8px 24px rgba(245, 158, 11, 0.3);
        }

        /* Grille des produits améliorée */
        .products-grid {
            display: none;
            grid-template-columns: repeat(auto-fill, minmax(340px, 1fr));
            gap: 32px;
            margin-bottom: 80px;
            padding: 0 8px;
        }

        .products-grid.active {
            display: grid;
        }

        .product-card {
            background: rgba(255, 255, 255, 0.8);
            border-radius: 20px;
            overflow: hidden;
            box-shadow: 0 4px 24px rgba(0, 0, 0, 0.06);
            transition: all 0.4s cubic-bezier(0.25, 0.46, 0.45, 0.94);
            cursor: pointer;
            position: relative;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(226, 232, 240, 0.5);
        }

        .product-card:hover {
            transform: translateY(-8px);
            box-shadow: 0 20px 48px rgba(0, 0, 0, 0.12);
            border-color: rgba(5, 150, 105, 0.2);
        }

        .product-card.hidden {
            display: none;
        }

        /* Images des produits avec ratio 2:1 */
        .product-image {
            width: 100%;
            height: 280px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 18px;
            font-weight: 600;
            position: relative;
            overflow: hidden;
        }

        .product-image img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            transition: transform 0.6s ease;
        }

        .product-card:hover .product-image img {
            transform: scale(1.05);
        }

        /* Arrière-plans de secours */
        .product-image.canva { background: linear-gradient(135deg, #6366f1 0%, #8b5cf6 100%); }
        .product-image.ebook { background: linear-gradient(135deg, #06b6d4 0%, #3b82f6 100%); }
        .product-image.formation { background: linear-gradient(135deg, #f59e0b 0%, #ef4444 100%); }
        .product-image.calendar { background: linear-gradient(135deg, #10b981 0%, #059669 100%); }
        .product-image.coaching { background: linear-gradient(135deg, #ef4444 0%, #dc2626 100%); }
        .product-image.webdesign { background: linear-gradient(135deg, #06b6d4 0%, #0ea5e9 100%); }
        .product-image.logistique { background: linear-gradient(135deg, #8b5cf6 0%, #7c3aed 100%); }

        .product-badge {
            position: absolute;
            top: 16px;
            right: 16px;
            background: linear-gradient(135deg, #dc2626, #b91c1c);
            color: white;
            padding: 6px 12px;
            border-radius: 12px;
            font-size: 12px;
            font-weight: 600;
            z-index: 10;
            box-shadow: 0 4px 16px rgba(220, 38, 38, 0.3);
        }

        .product-badge.new-badge {
            background: linear-gradient(135deg, #059669, #047857);
            box-shadow: 0 4px 16px rgba(5, 150, 105, 0.3);
        }

        /* Informations produit avec moins de hauteur */
        .product-info {
            padding: 24px;
            min-height: 180px;
            display: flex;
            flex-direction: column;
            justify-content: space-between;
        }

        .product-title {
            font-size: 16px;
            font-weight: 600;
            color: #1e293b;
            margin-bottom: 8px;
            line-height: 1.4;
            display: -webkit-box;
            -webkit-line-clamp: 3;
            -webkit-box-orient: vertical;
            overflow: hidden;
            text-overflow: ellipsis;
            min-height: 48px;
        }

        .product-category {
            font-size: 12px;
            color: #059669;
            background: rgba(5, 150, 105, 0.1);
            padding: 4px 8px;
            border-radius: 8px;
            display: inline-block;
            margin-bottom: 8px;
            font-weight: 500;
        }

        .product-rating {
            display: flex;
            align-items: center;
            gap: 8px;
            margin-bottom: 12px;
        }

        .stars {
            color: #f59e0b;
            font-size: 14px;
        }

        .rating-count {
            color: #64748b;
            font-size: 14px;
        }

        .product-price {
            font-size: 18px;
            font-weight: 700;
            color: #059669;
            margin-bottom: 8px;
        }

        .old-price {
            color: #94a3b8;
            text-decoration: line-through;
            font-size: 14px;
            margin-left: 8px;
            font-weight: 400;
        }

        .discount {
            background: linear-gradient(135deg, #dc2626, #b91c1c);
            color: white;
            padding: 2px 8px;
            border-radius: 8px;
            font-size: 12px;
            margin-left: 8px;
            font-weight: 600;
        }

        .product-actions {
            display: flex;
            gap: 8px;
            margin-top: auto;
        }

        .download-btn {
            flex: 1;
            background: linear-gradient(135deg, #059669, #047857);
            color: white;
            border: none;
            padding: 12px 16px;
            border-radius: 12px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            font-size: 14px;
        }

        .download-btn:hover {
            background: linear-gradient(135deg, #047857, #065f46);
            transform: translateY(-2px);
            box-shadow: 0 8px 24px rgba(5, 150, 105, 0.3);
        }

        .download-btn.premium {
            background: linear-gradient(135deg, #dc2626, #b91c1c);
        }

        .download-btn.premium:hover {
            background: linear-gradient(135deg, #b91c1c, #991b1b);
            box-shadow: 0 8px 24px rgba(220, 38, 38, 0.3);
        }

        .preview-btn {
            background: rgba(255, 255, 255, 0.8);
            color: #059669;
            border: 2px solid #059669;
            padding: 12px 16px;
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: 500;
            font-size: 14px;
            backdrop-filter: blur(10px);
        }

        .preview-btn:hover {
            background: #059669;
            color: white;
            transform: translateY(-2px);
        }

        /* Section Newsletter intégrée au footer */
        .footer {
            background: linear-gradient(135deg, #f1f5f9 0%, #e2e8f0 50%, #f8fafc 100%);
            color: #475569;
            padding: 0;
            margin-top: 80px;
            border-top: 1px solid rgba(226, 232, 240, 0.8);
        }

        .newsletter-section {
            background: linear-gradient(135deg, #059669 0%, #047857 100%);
            color: white;
            padding: 60px 40px;
            text-align: center;
            position: relative;
            overflow: hidden;
        }

        .newsletter-section::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><defs><pattern id="grid" width="10" height="10" patternUnits="userSpaceOnUse"><path d="M 10 0 L 0 0 0 10" fill="none" stroke="rgba(255,255,255,0.1)" stroke-width="0.5"/></pattern></defs><rect width="100" height="100" fill="url(%23grid)"/></svg>');
            opacity: 0.3;
        }

        .newsletter-container {
            max-width: 600px;
            margin: 0 auto;
            position: relative;
            z-index: 1;
        }

        .newsletter-title {
            font-size: 36px;
            font-weight: 700;
            margin-bottom: 16px;
            text-shadow: 0 2px 4px rgba(0,0,0,0.1);
            letter-spacing: -0.5px;
        }

        .newsletter-subtitle {
            font-size: 18px;
            margin-bottom: 32px;
            opacity: 0.9;
            line-height: 1.6;
        }

        .newsletter-form {
            display: flex;
            gap: 16px;
            max-width: 400px;
            margin: 0 auto;
            flex-wrap: wrap;
        }

        .newsletter-input {
            flex: 1;
            min-width: 200px;
            padding: 16px 20px;
            border: none;
            border-radius: 16px;
            font-size: 16px;
            outline: none;
            box-shadow: 0 4px 16px rgba(0,0,0,0.1);
            transition: all 0.3s ease;
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
        }

        .newsletter-input:focus {
            transform: translateY(-2px);
            box-shadow: 0 8px 32px rgba(0,0,0,0.15);
        }

        .newsletter-btn {
            padding: 16px 32px;
            background: rgba(255, 255, 255, 0.95);
            color: #059669;
            border: none;
            border-radius: 16px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 4px 16px rgba(0,0,0,0.1);
            backdrop-filter: blur(10px);
        }

        .newsletter-btn:hover {
            background: white;
            transform: translateY(-2px);
            box-shadow: 0 8px 32px rgba(0,0,0,0.15);
        }

        /* Footer principal */
        .footer-container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 60px 40px 40px;
        }

        .footer-content {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 48px;
            margin-bottom: 48px;
        }

        .footer-section h3 {
            font-size: 20px;
            font-weight: 600;
            margin-bottom: 24px;
            color: #1e293b;
        }

        .footer-section p {
            color: #64748b;
            line-height: 1.7;
            margin-bottom: 20px;
        }

        .footer-section ul {
            list-style: none;
        }

        .footer-section ul li {
            margin-bottom: 12px;
        }

        .footer-section a {
            color: #64748b;
            text-decoration: none;
            transition: all 0.3s ease;
            cursor: pointer;
            font-weight: 400;
        }

        .footer-section a:hover {
            color: #059669;
        }

        .social-icons {
            display: flex;
            gap: 16px;
        }

        .social-icon {
            width: 44px;
            height: 44px;
            background: rgba(5, 150, 105, 0.1);
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #059669;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: 600;
            font-size: 18px;
            text-decoration: none;
        }

        .social-icon:hover {
            background: #059669;
            color: white;
            transform: translateY(-2px);
            box-shadow: 0 8px 24px rgba(5, 150, 105, 0.25);
        }

        .social-icon.facebook {
            background: rgba(24, 119, 242, 0.1);
            color: #1877f2;
        }

        .social-icon.facebook:hover {
            background: #1877f2;
            color: white;
            box-shadow: 0 8px 24px rgba(24, 119, 242, 0.25);
        }

        .social-icon.instagram {
            background: rgba(225, 48, 108, 0.1);
            color: #e1306c;
        }

        .social-icon.instagram:hover {
            background: linear-gradient(45deg, #e1306c, #fd1d1d, #fcb045);
            color: white;
            box-shadow: 0 8px 24px rgba(225, 48, 108, 0.25);
        }

        .social-icon.linkedin {
            background: rgba(0, 119, 181, 0.1);
            color: #0077b5;
        }

        .social-icon.linkedin:hover {
            background: #0077b5;
            color: white;
            box-shadow: 0 8px 24px rgba(0, 119, 181, 0.25);
        }

        .social-icon.youtube {
            background: rgba(255, 0, 0, 0.1);
            color: #ff0000;
        }

        .social-icon.youtube:hover {
            background: #ff0000;
            color: white;
            box-shadow: 0 8px 24px rgba(255, 0, 0, 0.25);
        }

        .footer-bottom {
            border-top: 1px solid rgba(226, 232, 240, 0.8);
            padding-top: 24px;
            text-align: center;
            color: #64748b;
            font-size: 14px;
        }

        .footer-bottom .heart {
            color: #dc2626;
            animation: heartbeat 1.5s ease-in-out infinite;
        }

        @keyframes heartbeat {
            0% { transform: scale(1); }
            14% { transform: scale(1.2); }
            28% { transform: scale(1); }
            42% { transform: scale(1.2); }
            70% { transform: scale(1); }
        }

        /* Styles pour les formulaires */
        .form-section, .product-detail-section {
            background: rgba(255, 255, 255, 0.8);
            padding: 40px;
            border-radius: 20px;
            box-shadow: 0 8px 32px rgba(0,0,0,0.08);
            max-width: 800px;
            margin: 40px auto;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(226, 232, 240, 0.5);
        }

        .form-title, .detail-title {
            font-size: 28px;
            font-weight: 700;
            color: #1e293b;
            margin-bottom: 32px;
            text-align: center;
            letter-spacing: -0.5px;
        }

        .form-group {
            margin-bottom: 24px;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 500;
            color: #374151;
            font-size: 15px;
        }

        .form-group input[type="text"],
        .form-group input[type="email"],
        .form-group input[type="password"],
        .form-group input[type="number"],
        .form-group input[type="file"],
        .form-group select,
        .form-group textarea {
            width: 100%;
            padding: 16px;
            border: 2px solid #e2e8f0;
            border-radius: 12px;
            font-size: 16px;
            transition: all 0.3s ease;
            background: rgba(255, 255, 255, 0.8);
            backdrop-filter: blur(10px);
        }

        .form-group input:focus, .form-group select:focus, .form-group textarea:focus {
            outline: none;
            border-color: #059669;
            box-shadow: 0 0 0 4px rgba(5, 150, 105, 0.1);
            background: white;
        }

        .form-actions {
            text-align: center;
            margin-top: 32px;
        }

        .form-submit-btn {
            background: linear-gradient(135deg, #059669, #047857);
            color: white;
            border: none;
            padding: 16px 32px;
            border-radius: 16px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 4px 16px rgba(5, 150, 105, 0.3);
        }

        .form-submit-btn:hover {
            background: linear-gradient(135deg, #047857, #065f46);
            transform: translateY(-2px);
            box-shadow: 0 8px 24px rgba(5, 150, 105, 0.4);
        }

        /* Styles pour la page de détail */
        .product-detail-content {
            display: flex;
            gap: 40px;
            margin-bottom: 40px;
        }

        .product-detail-image-container {
            flex: 1;
            min-width: 300px;
            height: 400px;
            background: #f8fafc;
            border-radius: 16px;
            display: flex;
            align-items: center;
            justify-content: center;
            overflow: hidden;
            border: 1px solid #e2e8f0;
        }
        
        .product-detail-image-container img, .product-detail-image-container video {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .product-detail-info {
            flex: 1;
        }

        .detail-category {
            font-size: 14px;
            color: #059669;
            background: rgba(5, 150, 105, 0.1);
            padding: 6px 12px;
            border-radius: 12px;
            display: inline-block;
            margin-bottom: 16px;
            font-weight: 500;
        }

        .detail-seller {
            color: #64748b;
            margin-bottom: 20px;
            font-size: 16px;
        }

        .detail-price {
            font-size: 32px;
            font-weight: 700;
            color: #059669;
            margin-bottom: 24px;
        }

        .detail-actions {
            display: flex;
            gap: 16px;
            margin-bottom: 24px;
            align-items: center;
        }
        
        .detail-like-btn {
            background: rgba(255, 255, 255, 0.8);
            border: 2px solid #dc2626;
            color: #dc2626;
            width: 60px;
            height: 48px;
            border-radius: 12px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            transition: all 0.3s ease;
            font-weight: 500;
            backdrop-filter: blur(10px);
        }

        .detail-like-btn:hover {
            background: #dc2626;
            color: white;
            transform: translateY(-2px);
            box-shadow: 0 8px 24px rgba(220, 38, 38, 0.3);
        }

        .detail-description {
            line-height: 1.8;
            color: #475569;
            font-size: 16px;
        }

        /* Section des commentaires */
        .comments-section {
            margin-top: 48px;
            border-top: 1px solid #e2e8f0;
            padding-top: 32px;
        }

        .comments-section h4 {
            font-size: 20px;
            margin-bottom: 24px;
            font-weight: 600;
            color: #1e293b;
        }
        
        #commentsList .comment-item {
            margin-bottom: 20px;
            padding: 20px;
            border-radius: 12px;
            background: rgba(248, 250, 252, 0.8);
            border: 1px solid #e2e8f0;
        }

        #commentsList .comment-author {
            font-weight: 600;
            color: #1e293b;
            margin-bottom: 8px;
        }
        
        #commentsList .comment-text {
            color: #64748b;
            line-height: 1.6;
        }
        
        .comment-form {
            margin-top: 24px;
            padding: 24px;
            background: rgba(248, 250, 252, 0.5);
            border-radius: 16px;
            border: 1px solid #e2e8f0;
        }
        
        .comment-form h5 {
            margin-bottom: 16px;
            font-weight: 600;
            color: #1e293b;
        }

        .comment-form textarea {
            width: 100%;
            height: 100px;
            padding: 16px;
            border-radius: 12px;
            border: 2px solid #e2e8f0;
            margin-bottom: 16px;
            resize: vertical;
            font-family: inherit;
            transition: all 0.3s ease;
        }

        .comment-form textarea:focus {
            border-color: #059669;
            box-shadow: 0 0 0 4px rgba(5, 150, 105, 0.1);
        }
        
        .comment-form button {
            background: linear-gradient(135deg, #059669, #047857);
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: 500;
        }
        
        .comment-form button:hover {
            background: linear-gradient(135deg, #047857, #065f46);
            transform: translateY(-2px);
            box-shadow: 0 8px 24px rgba(5, 150, 105, 0.3);
        }

        /* Indicateur de chargement */
        .loading-spinner {
            display: none;
            text-align: center;
            padding: 60px;
        }

        .spinner {
            width: 48px;
            height: 48px;
            border: 4px solid #e2e8f0;
            border-top: 4px solid #059669;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin: 0 auto 24px;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* MODALE D'AUTHENTIFICATION */
        .auth-modal {
            display: none;
            position: fixed;
            z-index: 3000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            overflow: auto;
            background-color: rgba(0,0,0,0.6);
            backdrop-filter: blur(8px);
            padding: 20px;
            box-sizing: border-box;
        }

        .auth-modal-content {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(20px);
            margin: 5% auto;
            padding: 32px;
            border: 1px solid rgba(226, 232, 240, 0.5);
            width: 100%;
            max-width: 420px;
            max-height: 90vh;
            border-radius: 20px;
            box-shadow: 0 20px 64px rgba(0,0,0,0.15);
            position: relative;
            animation: slideIn 0.4s cubic-bezier(0.25, 0.46, 0.45, 0.94);
            overflow-y: auto;
            box-sizing: border-box;
        }

        @keyframes slideIn {
            from { transform: translateY(-32px); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }

        .auth-modal .close-btn {
            color: #94a3b8;
            position: absolute;
            top: 20px;
            right: 24px;
            font-size: 24px;
            font-weight: bold;
            cursor: pointer;
            width: 32px;
            height: 32px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 8px;
            transition: all 0.3s ease;
        }

        .auth-modal .close-btn:hover {
            color: #dc2626;
            background: rgba(239, 68, 68, 0.1);
        }
        
        .auth-modal h2 {
            text-align: center;
            margin-bottom: 32px;
            font-size: 28px;
            font-weight: 700;
            color: #1e293b;
            background: linear-gradient(135deg, #059669, #3b82f6);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .google-btn {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 12px;
            width: 100%;
            padding: 16px;
            border-radius: 16px;
            border: 2px solid #e2e8f0;
            background: rgba(255, 255, 255, 0.9);
            font-size: 16px;
            cursor: pointer;
            transition: all 0.3s ease;
            margin-bottom: 24px;
            font-weight: 500;
            backdrop-filter: blur(10px);
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05);
        }
        
        .google-btn:hover {
            box-shadow: 0 8px 24px rgba(0,0,0,0.08);
            transform: translateY(-2px);
            background: white;
            border-color: #d1d5db;
        }

        .auth-form-group {
            margin-bottom: 24px;
            position: relative;
        }

        .auth-form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #374151;
            font-size: 14px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .auth-form-group input {
            width: 100%;
            padding: 16px 20px;
            border: 2px solid #e2e8f0;
            border-radius: 12px;
            font-size: 16px;
            transition: all 0.3s ease;
            background: rgba(255, 255, 255, 0.8);
            backdrop-filter: blur(10px);
            box-sizing: border-box;
        }

        .auth-form-group input:focus {
            outline: none;
            border-color: #059669;
            box-shadow: 0 0 0 4px rgba(5, 150, 105, 0.1);
            background: white;
            transform: translateY(-1px);
        }

        .auth-form-group input::placeholder {
            color: #9ca3af;
            font-size: 15px;
        }

        .auth-form-group .input-icon {
            position: absolute;
            right: 16px;
            top: 50%;
            transform: translateY(-50%);
            color: #9ca3af;
            font-size: 18px;
            pointer-events: none;
        }

        .password-toggle {
            position: absolute;
            right: 16px;
            top: 50%;
            transform: translateY(-50%);
            background: none;
            border: none;
            color: #6b7280;
            cursor: pointer;
            font-size: 16px;
            padding: 4px;
            border-radius: 4px;
            transition: color 0.3s ease;
        }

        .password-toggle:hover {
            color: #059669;
        }

        .auth-submit-btn {
            width: 100%;
            background: linear-gradient(135deg, #059669, #047857);
            color: white;
            border: none;
            padding: 18px 32px;
            border-radius: 16px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 4px 16px rgba(5, 150, 105, 0.3);
            text-transform: uppercase;
            letter-spacing: 0.5px;
            margin-top: 8px;
        }

        .auth-submit-btn:hover {
            background: linear-gradient(135deg, #047857, #065f46);
            transform: translateY(-2px);
            box-shadow: 0 8px 24px rgba(5, 150, 105, 0.4);
        }

        .auth-submit-btn:active {
            transform: translateY(0);
        }

        .checkbox-group {
            display: flex;
            align-items: center;
            gap: 12px;
            margin-bottom: 24px;
        }

        .checkbox-group input[type="checkbox"] {
            width: 18px;
            height: 18px;
            accent-color: #059669;
            cursor: pointer;
        }

        .checkbox-group label {
            font-size: 14px;
            color: #6b7280;
            cursor: pointer;
            margin: 0;
            text-transform: none;
            letter-spacing: normal;
            font-weight: 400;
        }

        .forgot-password {
            text-align: right;
            margin-top: -16px;
            margin-bottom: 24px;
        }

        .forgot-password a {
            color: #059669;
            text-decoration: none;
            font-size: 14px;
            font-weight: 500;
            transition: color 0.3s ease;
        }

        .forgot-password a:hover {
            color: #047857;
            text-decoration: underline;
        }
        
        .divider {
            text-align: center;
            margin: 24px 0;
            color: #94a3b8;
            position: relative;
        }

        .divider::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 0;
            right: 0;
            height: 1px;
            background: #e2e8f0;
            z-index: 1;
        }

        .divider::after {
            content: 'ou';
            background: rgba(255, 255, 255, 0.95);
            padding: 0 16px;
            position: relative;
            z-index: 2;
        }
        
        .auth-form-toggle {
            text-align: center;
            margin-top: 24px;
        }
        
        .auth-form-toggle a {
            color: #059669;
            text-decoration: none;
            font-weight: 500;
            cursor: pointer;
            transition: color 0.3s ease;
        }
        
        .auth-form-toggle a:hover {
            color: #047857;
            text-decoration: underline;
        }

        /* Boutons d'édition/suppression */
        .product-owner-actions {
            display: flex;
            gap: 8px;
            margin-top: 12px;
        }

        .edit-btn, .delete-btn {
            flex: 1;
            padding: 8px 12px;
            border-radius: 8px;
            border: none;
            color: white;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s ease;
            text-align: center;
            font-size: 13px;
        }
        
        .edit-btn {
            background: linear-gradient(135deg, #f59e0b, #d97706);
        }
        .edit-btn:hover {
            background: linear-gradient(135deg, #d97706, #b45309);
            transform: translateY(-1px);
        }
        
        .delete-btn {
            background: linear-gradient(135deg, #dc2626, #b91c1c);
        }
        .delete-btn:hover {
            background: linear-gradient(135deg, #b91c1c, #991b1b);
            transform: translateY(-1px);
        }

        /* Responsive Design */
        @media (max-width: 1024px) {
            .nav-container {
                gap: 32px;
            }
            
            .products-grid {
                grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
                gap: 24px;
            }
        }

        @media (max-width: 768px) {
            .header {
                padding: 8px 16px 12px;
            }

            .header-flag-section {
                margin-bottom: 8px;
                padding: 6px 0;
            }

            .flag-text {
                font-size: 11px;
            }

            .header-container {
                flex-direction: column;
                gap: 12px;
                align-items: stretch;
            }

            /* Première ligne mobile : Logo + Actions */
            .header-top {
                display: flex;
                justify-content: space-between;
                align-items: center;
                width: 100%;
            }

            .logo {
                font-size: 18px;
                min-width: fit-content;
            }

            /* Deuxième ligne mobile : Barre de recherche pleine largeur */
            .search-container {
                width: 100%;
                margin: 0;
                order: 2;
                max-width: 100%;
            }

            .search-bar {
                padding: 12px 40px 12px 16px;
                font-size: 14px;
                width: 100%;
            }

            .search-btn {
                width: 36px;
                height: 36px;
                font-size: 14px;
            }

            .header-actions {
                gap: 8px;
                flex-wrap: nowrap;
            }

            .btn-header, .auth-btn {
                padding: 8px 10px;
                font-size: 12px;
                border-radius: 8px;
                min-width: 60px;
            }

            .cart-icon {
                width: 32px;
                height: 32px;
                font-size: 16px;
            }

            .mobile-menu {
                display: flex;
                padding: 4px;
            }

            .mobile-menu span {
                width: 18px;
                height: 1.5px;
            }

            .nav {
                display: none;
            }

            .mobile-nav {
                display: block;
            }

            .hero-title {
                font-size: 32px;
            }

            .hero-subtitle {
                font-size: 16px;
            }

            .products-grid {
                grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
                gap: 20px;
                padding: 0 4px;
            }

            .filters {
                justify-content: center;
                padding: 20px;
            }

            .filter-btn {
                font-size: 13px;
                padding: 10px 16px;
            }

            .newsletter-title {
                font-size: 28px;
            }

            .newsletter-subtitle {
                font-size: 16px;
            }

            .newsletter-form {
                flex-direction: column;
                align-items: center;
            }

            .newsletter-input {
                width: 100%;
                max-width: 320px;
            }

            .newsletter-btn {
                width: 100%;
                max-width: 200px;
            }

            .product-detail-content {
                flex-direction: column;
                gap: 24px;
            }

            .product-detail-image-container {
                min-width: unset;
                height: 300px;
            }

            .auth-modal {
                padding: 16px;
            }

            .auth-modal-content {
                margin: 10% auto;
                padding: 24px;
                max-height: 85vh;
            }

            .footer-container {
                padding: 48px 24px 32px;
            }

            .footer-content {
                gap: 32px;
            }

            /* Menu utilisateur sur mobile */
            .user-dropdown {
                position: fixed;
                top: auto;
                bottom: 0;
                left: 0;
                right: 0;
                border-radius: 16px 16px 0 0;
                margin-top: 0;
                min-width: unset;
                max-width: unset;
                z-index: 3000;
            }

            .user-dropdown.active {
                animation: slideUp 0.3s ease-out;
            }

            @keyframes slideUp {
                from {
                    transform: translateY(100%);
                }
                to {
                    transform: translateY(0);
                }
            }

            #username-display {
                font-size: 12px;
                max-width: 80px;
                overflow: hidden;
                text-overflow: ellipsis;
                white-space: nowrap;
                font-weight: 500;
            }
        }

        @media (max-width: 480px) {
            .main {
                padding: 32px 12px;
            }

            .header {
                padding: 6px 12px 10px;
            }

            .header-flag-section {
                margin-bottom: 6px;
                padding: 4px 0;
            }

            .flag-text {
                font-size: 10px;
            }

            .header-container {
                gap: 8px;
            }

            .logo {
                font-size: 16px;
            }

            .search-container {
                margin: 0;
            }

            .search-bar {
                padding: 10px 35px 10px 12px;
                font-size: 13px;
            }

            .search-btn {
                width: 32px;
                height: 32px;
                font-size: 13px;
            }

            .btn-header, .auth-btn {
                padding: 6px 8px;
                font-size: 11px;
                min-width: 50px;
            }

            .cart-icon {
                width: 28px;
                height: 28px;
                font-size: 14px;
            }

            .products-grid {
                grid-template-columns: 1fr;
                gap: 16px;
            }

            .product-card {
                font-size: 14px;
            }

            .product-info {
                padding: 20px;
                height: auto;
            }

            .product-title {
                font-size: 15px;
            }

            .product-price {
                font-size: 16px;
            }

            .newsletter-section {
                padding: 48px 20px;
            }

            .newsletter-title {
                font-size: 24px;
            }

            .newsletter-subtitle {
                font-size: 14px;
            }

            .product-actions {
                flex-direction: column;
                gap: 8px;
            }

            .download-btn, .preview-btn {
                width: 100%;
            }

            .form-section, .product-detail-section {
                padding: 20px;
                margin: 20px auto;
            }

            .form-title, .detail-title {
                font-size: 24px;
            }

            .product-detail-image-container {
                height: 250px;
            }

            .detail-actions {
                flex-direction: column;
                align-items: stretch;
            }

            .detail-like-btn {
                width: 100%;
                height: 48px;
            }

            .auth-modal {
                padding: 12px;
            }

            .auth-modal-content {
                margin: 5% auto;
                padding: 20px;
                max-height: 90vh;
            }

            .auth-modal h2 {
                font-size: 20px;
                margin-bottom: 24px;
            }

            .google-btn {
                padding: 12px;
                font-size: 14px;
            }

            .auth-form-group input {
                padding: 12px;
                font-size: 14px;
            }

            #username-display {
                max-width: 40px;
            }
        }
    </style>
</head>
<body>
    <header class="header">
        <div class="header-flag-section">
            <div class="flag-mg-header"></div>
            <span class="flag-text">Plateforme basée à Madagascar</span>
        </div>
        
        <div class="header-container">
            <div class="header-top">
                <div class="logo">SmartDigitalPro</div>
                
                <div class="header-actions">
                    <a href="#" class="btn-header btn-sell" data-action="sell">Vendre</a>
                    <div id="auth-links">
                        <button class="auth-btn" data-action="show-auth">
                            👤 Compte
                        </button>
                    </div>
                    <div id="user-profile" class="user-menu" style="display: none;">
                        <button class="auth-btn" id="userMenuBtn">
                            👤 <span id="username-display"></span>
                        </button>
                        <div class="user-dropdown" id="userDropdown">
                            <div class="user-info">
                                <div class="user-name" id="userDropdownName"></div>
                                <div class="user-email" id="userDropdownEmail"></div>
                            </div>
                            <a href="#" class="user-menu-item" data-action="profile">Mon profil</a>
                            <a href="#" class="user-menu-item" data-action="orders">Mes commandes</a>
                            <a href="#" class="user-menu-item" data-action="products">Mes produits</a>
                            <a href="#" class="user-menu-item logout" data-action="logout">Déconnexion</a>
                        </div>
                    </div>
                    <div class="cart-icon">🛒</div>
                    <div class="mobile-menu">
                        <span></span>
                        <span></span>
                        <span></span>
                    </div>
                </div>
            </div>
            
            <div class="search-container">
                <input type="text" class="search-bar" id="searchInput" placeholder="Rechercher des produits numériques...">
                <button class="search-btn">🔍</button>
            </div>
        </div>
    </header>

    <nav class="nav">
        <div class="nav-container">
            <a class="nav-link" data-section="home">Accueil</a>
            <a class="nav-link" data-section="products">Produits</a>
            <a class="nav-link" data-section="formations">Formations</a>
            <a class="nav-link" data-section="services">Services</a>
            <a class="nav-link" data-section="blog">Blog</a>
            <a class="nav-link" data-section="contact">Contact</a>
        </div>
    </nav>

    <div class="mobile-nav">
        <div class="mobile-nav-close">×</div>
        <div class="mobile-nav-container">
            <a class="mobile-nav-link" data-section="home">🏠 Accueil</a>
            <a class="mobile-nav-link" data-action="sell">💰 Vendre un produit</a>
            <a class="mobile-nav-link" data-section="products">📦 Produits</a>
            <a class="mobile-nav-link" data-section="formations">🎓 Formations</a>
            <a class="mobile-nav-link" data-section="services">⚙️ Services</a>
            <a class="mobile-nav-link" data-section="blog">📝 Blog</a>
            <a class="mobile-nav-link" data-section="contact">📧 Contact</a>
        </div>
    </div>

    <main class="main">
        <section class="hero-section" id="home">
            <h1 class="hero-title" id="heroTitle">Les produits numériques les plus vendus</h1>
            <p class="hero-subtitle" id="heroSubtitle">1000+ résultats pertinents</p>
        </section>
        
        <section id="productsContainer">
            <div class="search-results" id="searchResults">
                <div class="search-results-text" id="searchResultsText"></div>
                <div class="search-results-count" id="searchResultsCount"></div>
            </div>

            <div class="no-results" id="noResults">
                <div class="no-results-icon">🔍</div>
                <div class="no-results-title">Aucun produit ne correspond à votre recherche</div>
                <div class="no-results-text">Essayez d'autres mots-clés ou parcourez nos catégories populaires.</div>
                <button class="clear-search-btn">Effacer la recherche</button>
            </div>

            <div class="loading-spinner" id="loadingSpinner">
                <div class="spinner"></div>
                <p>Recherche en cours...</p>
            </div>

            <div class="filters" id="filtersSection">
                <button class="filter-btn top-seller" data-filter="top-seller">Top vente</button>
                <button class="filter-btn" data-filter="all">Téléchargement numérique</button>
                <button class="filter-btn" data-filter="madagascar">Pays : Madagascar</button>
                <button class="filter-btn" data-filter="canva">Modèles Canva</button>
                <button class="filter-btn" data-filter="ebook">E-books</button>
                <button class="filter-btn" data-filter="formation">Formations vidéo</button>
                <button class="filter-btn" data-filter="coaching">Coaching</button>
            </div>

            <div class="products-grid" id="productsGridSection">
                </div>
        </section>

        <section class="form-section" id="sellProductForm">
            <h2 class="form-title">Proposer un nouveau produit ou service</h2>
            <form id="productPublishForm">
                <input type="hidden" id="editingProductId" value="">
                <div class="form-group">
                    <label for="productTitle">Titre du produit ou service :</label>
                    <input type="text" id="productTitle" name="productTitle" required>
                </div>
                <div class="form-group">
                    <label for="productCategory">Catégorie :</label>
                    <select id="productCategory" name="productCategory" required>
                        <option value="">Sélectionnez une catégorie</option>
                        <option value="canva">Modèles Canva</option>
                        <option value="ebook">E-books</option>
                        <option value="formation">Formations vidéo</option>
                        <option value="coaching">Coaching</option>
                        <option value="webdesign">Web Design</option>
                        <option value="logistique">Logistique</option>
                        <option value="other">Autres</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="productDescription">Description :</label>
                    <textarea id="productDescription" name="productDescription" rows="6" required></textarea>
                </div>
                <div class="form-group">
                    <label for="productFile">Image ou fichier à uploader (PDF, vidéo, zip, etc.) :</label>
                    <input type="file" id="productFile" name="productFile" accept=".pdf,.zip,.mp4,.jpg,.png,.gif">
                </div>
                <div class="form-group">
                    <label for="productPrice">Prix (MGA) :</label>
                    <input type="number" id="productPrice" name="productPrice" step="100" min="0" required>
                </div>
                <div class="form-group">
                    <label for="productPreview">Aperçu (URL ou fichier, optionnel) :</label>
                    <input type="text" id="productPreview" name="productPreview" placeholder="URL de l'aperçu ou uploader un fichier">
                    <input type="file" id="productPreviewFile" name="productPreviewFile" accept=".pdf,.mp4,.jpg,.png,.gif">
                </div>
                <div class="form-actions">
                    <button type="submit" class="form-submit-btn">Soumettre le produit</button>
                </div>
            </form>
        </section>

        <section class="form-section" id="downloadForm">
            <h2 class="form-title">Télécharger votre produit</h2>
            <p style="text-align: center; margin-bottom: 20px; color: #666;">Veuillez remplir vos informations pour accéder au téléchargement.</p>
            <form id="downloadInfoForm">
                <div class="form-group">
                    <label for="downloadName">Votre Nom :</label>
                    <input type="text" id="downloadName" name="downloadName" required>
                </div>
                <div class="form-group">
                    <label for="downloadEmail">Votre Email :</label>
                    <input type="email" id="downloadEmail" name="downloadEmail" required>
                </div>
                <div class="form-actions">
                    <button type="submit" class="form-submit-btn">Accéder au téléchargement</button>
                </div>
            </form>
        </section>

        <section class="product-detail-section" id="productDetail">
            <h2 class="detail-title" id="detailProductTitle">Titre du Produit Détaillé</h2>
            <div class="product-detail-content">
                <div class="product-detail-image-container" id="detailProductImage">
                    Aperçu du Produit
                </div>
                <div class="product-detail-info">
                    <div class="detail-category" id="detailProductCategory">Catégorie</div>
                    <p class="detail-seller">Vendu par : <span id="detailProductSeller">Nom du Vendeur</span></p>
                    <div class="detail-price" id="detailProductPrice">0 MGA</div>
                    <div class="detail-actions">
                        <button class="download-btn" id="detailDownloadBtn" data-action="download">Télécharger</button>
                        <button class="detail-like-btn" id="detailLikeBtn" data-action="like">❤️ <span id="likeCount">0</span></button>
                    </div>
                    <p class="detail-description" id="detailProductDescription">Description complète du produit/service.</p>
                </div>
            </div>
            <div class="comments-section">
                <h4>Commentaires (<span id="commentCount">0</span>)</h4>
                <div id="commentsList">
                    </div>
                <div class="comment-form" data-action="comment">
                    <h5>Laisser un commentaire :</h5>
                    <textarea id="newCommentText" placeholder="Écrivez votre commentaire ici..."></textarea>
                    <button id="submitCommentBtn">Soumettre</button>
                </div>
            </div>
        </section>
    </main>

    <div id="authModal" class="auth-modal">
        <div class="auth-modal-content">
            <span class="close-btn">&times;</span>

            <div id="loginForm">
                <h2>Connexion</h2>
                <form>
                    <button type="button" class="google-btn">
                        <img src="https://www.google.com/favicon.ico" alt="Google icon" width="20" height="20">
                        Continuer avec Google
                    </button>
                    <div class="divider"></div>
                    <div class="auth-form-group">
                        <label for="loginEmail">Adresse email</label>
                        <input type="email" id="loginEmail" placeholder="votre@email.com" required>
                        <span class="input-icon">📧</span>
                    </div>
                    <div class="auth-form-group">
                        <label for="loginPassword">Mot de passe</label>
                        <input type="password" id="loginPassword" placeholder="••••••••" required>
                        <button type="button" class="password-toggle" onclick="togglePassword('loginPassword')">👁️</button>
                    </div>
                    <div class="forgot-password">
                        <a href="#" onclick="alert('Fonctionnalité à venir')">Mot de passe oublié ?</a>
                    </div>
                    <div class="checkbox-group">
                        <input type="checkbox" id="rememberMe">
                        <label for="rememberMe">Se souvenir de moi</label>
                    </div>
                    <button type="submit" class="auth-submit-btn" data-action="login-submit">Se connecter</button>
                    <div class="auth-form-toggle">
                        <p>Pas encore de compte ? <a data-action="show-register">Créer un compte</a></p>
                    </div>
                </form>
            </div>

            <div id="registerForm" style="display:none;">
                <h2>Créer un compte</h2>
                <form>
                     <button type="button" class="google-btn">
                        <img src="https://www.google.com/favicon.ico" alt="Google icon" width="20" height="20">
                        S'inscrire avec Google
                    </button>
                    <div class="divider"></div>
                    <div class="auth-form-group">
                        <label for="registerFirstName">Prénom</label>
                        <input type="text" id="registerFirstName" placeholder="Votre prénom" required>
                        <span class="input-icon">👤</span>
                    </div>
                    <div class="auth-form-group">
                        <label for="registerLastName">Nom</label>
                        <input type="text" id="registerLastName" placeholder="Votre nom" required>
                        <span class="input-icon">👤</span>
                    </div>
                    <div class="auth-form-group">
                        <label for="registerEmail">Adresse email</label>
                        <input type="email" id="registerEmail" placeholder="votre@email.com" required>
                        <span class="input-icon">📧</span>
                    </div>
                    <div class="auth-form-group">
                        <label for="registerPhone">Téléphone (optionnel)</label>
                        <input type="tel" id="registerPhone" placeholder="+261 32 00 000 00">
                        <span class="input-icon">📱</span>
                    </div>
                    <div class="auth-form-group">
                        <label for="registerPassword">Mot de passe</label>
                        <input type="password" id="registerPassword" placeholder="••••••••" required>
                        <button type="button" class="password-toggle" onclick="togglePassword('registerPassword')">👁️</button>
                    </div>
                    <div class="auth-form-group">
                        <label for="confirmPassword">Confirmer le mot de passe</label>
                        <input type="password" id="confirmPassword" placeholder="••••••••" required>
                        <button type="button" class="password-toggle" onclick="togglePassword('confirmPassword')">👁️</button>
                    </div>
                    <div class="checkbox-group">
                        <input type="checkbox" id="acceptTerms" required>
                        <label for="acceptTerms">J'accepte les <a href="#" style="color: #059669;">conditions d'utilisation</a> et la <a href="#" style="color: #059669;">politique de confidentialité</a></label>
                    </div>
                    <div class="checkbox-group">
                        <input type="checkbox" id="newsletter">
                        <label for="newsletter">Je souhaite recevoir les newsletters et offres spéciales</label>
                    </div>
                    <button type="submit" class="auth-submit-btn" data-action="register-submit">Créer mon compte</button>
                    <div class="auth-form-toggle">
                        <p>Déjà un compte ? <a data-action="show-login">Se connecter</a></p>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- Footer avec Newsletter intégrée - Affiché seulement sur la page d'accueil -->
    <footer class="footer" id="mainFooter" style="display: none;">
        <!-- Section Newsletter en haut du footer -->
        <section class="newsletter-section">
            <div class="newsletter-container">
                <h2 class="newsletter-title">Rejoignez notre Newsletter</h2>
                <p class="newsletter-subtitle">Recevez les dernières offres et astuces en marketing digital directement dans votre boîte de réception.</p>
                <form class="newsletter-form">
                    <input type="email" class="newsletter-input" placeholder="Votre adresse email" required>
                    <button type="submit" class="newsletter-btn">S'abonner</button>
                </form>
            </div>
        </section>

        <!-- Contenu principal du footer -->
        <div class="footer-container">
            <div class="footer-content">
                <div class="footer-section">
                    <h3>SmartDigitalPro</h3>
                    <p>Votre plateforme de référence pour les produits et services numériques à Madagascar. Boostez votre business avec nos solutions innovantes.</p>
                    <div class="social-icons">
                        <a href="#" class="social-icon facebook">📘</a>
                        <a href="#" class="social-icon instagram">📷</a>
                        <a href="#" class="social-icon linkedin">💼</a>
                        <a href="#" class="social-icon youtube">📺</a>
                    </div>
                </div>
                <div class="footer-section">
                    <h3>Liens Rapides</h3>
                    <ul>
                        <li><a data-section="home">Accueil</a></li>
                        <li><a data-section="products">Produits</a></li>
                        <li><a data-section="formations">Formations</a></li>
                        <li><a data-section="services">Services</a></li>
                        <li><a data-section="blog">Blog</a></li>
                        <li><a href="#" onclick="document.querySelector('.newsletter-input').focus()">S'abonner</a></li>
                    </ul>
                </div>
                <div class="footer-section">
                    <h3>Support</h3>
                    <ul>
                        <li><a href="#">FAQ</a></li>
                        <li><a href="#">Contactez-nous</a></li>
                        <li><a href="#">Politique de Confidentialité</a></li>
                        <li><a href="#">Conditions Générales</a></li>
                    </ul>
                </div>
                <div class="footer-section">
                    <h3>Contact</h3>
                    <p>Antananarivo, Madagascar</p>
                    <p>Email: contact@smartdigitalpro.mg</p>
                    <p>Téléphone: +261 32 12 345 67</p>
                </div>
            </div>
            <div class="footer-bottom">
                &copy; 2024 SmartDigitalPro. Tous droits réservés. Fait avec <span class="heart">❤️</span> à Madagascar.
            </div>
        </div>
    </footer>

    <script type="module">
        // --- AUTHENTIFICATION SIMULÉE ---
        let authState = {
            isLoggedIn: false,
            currentUser: null
        };
        
        const users = [
            { id: 'user1', name: 'Jean Dupont', email: 'jean@test.com', password: 'password123' }
        ];

        let products = [
            {
                id: 'product1',
                creatorId: 'user1',
                title: '100 modèles Canva pour les réseaux sociaux',
                category: 'Modèles Canva',
                categorySlug: 'canva',
                description: 'Un pack complet de 100 modèles Canva professionnels et personnalisables pour dynamiser votre présence sur les réseaux sociaux. Idéal pour Instagram, Facebook, et plus encore. Gagnez du temps et créez du contenu percutant en quelques clics.',
                image: 'https://raw.githubusercontent.com/balisama21/plateforme/main/canva.jpg',
                price: 25000,
                oldPrice: 35000,
                discount: 29,
                seller: 'Jean Dupont',
                likes: 1250,
                isTopSeller: true,
                comments: [
                    { author: 'Utilisateur Alpha', text: 'Super produit, très utile pour ma stratégie marketing !' },
                    { author: 'Designer Pro', text: 'Les modèles sont très bien conçus et faciles à modifier. Je recommande !' }
                ]
            },
            {
                id: 'product2',
                creatorId: 'user2',
                title: 'E-book : Les fondamentaux du Marketing Digital',
                category: 'E-books',
                categorySlug: 'ebook',
                description: 'Découvrez les bases essentielles du marketing digital avec cet e-book complet. Apprenez le SEO, le SEM, le marketing de contenu, les réseaux sociaux et bien plus encore pour propulser votre activité en ligne.',
                image: 'https://raw.githubusercontent.com/balisama21/plateforme/main/ebook.jpg',
                price: 15000,
                oldPrice: null,
                discount: null,
                seller: 'DigitalExpert',
                likes: 800,
                isTopSeller: false,
                comments: [
                    { author: 'Lecteur Curieux', text: 'Très instructif, j\'ai appris beaucoup de choses.' },
                    { author: 'Entrepreneur Débutant', text: 'Une excellente ressource pour commencer en marketing digital.' }
                ]
            },
            {
                id: 'product3',
                creatorId: 'user3',
                title: 'Formation complète Adobe Premiere Pro (Débutant)',
                category: 'Formations Vidéo',
                categorySlug: 'formation',
                description: 'Maîtrisez Adobe Premiere Pro du débutant à un niveau intermédiaire avec cette formation vidéo détaillée. Apprenez le montage, l\'étalonnage, l\'ajout d\'effets et l\'exportation de vos projets pour des vidéos de qualité professionnelle.',
                image: 'https://raw.githubusercontent.com/balisama21/plateforme/main/formation.jpg',
                price: 50000,
                oldPrice: 70000,
                discount: 28,
                seller: 'VideoMaestro',
                likes: 2100,
                isTopSeller: true,
                comments: [
                    { author: 'Monteur Junior', text: 'La formation est très claire et les exercices pratiques sont super !' },
                    { author: 'Apprenti Vidéaste', text: 'J\'ai enfin compris comment utiliser Premiere Pro, merci !' }
                ]
            },
            {
                id: 'product4',
                creatorId: 'user4',
                title: 'Calendrier Éditorial 2024 pour Réseaux Sociaux',
                category: 'Outils',
                categorySlug: 'outils',
                description: 'Organisez votre contenu sur les réseaux sociaux avec notre calendrier éditorial pré-rempli pour 2024. Planifiez vos publications, suivez vos performances et optimisez votre stratégie de contenu tout au long de l\'année.',
                image: 'https://raw.githubusercontent.com/balisama21/plateforme/main/calendar.jpg',
                price: 10000,
                oldPrice: null,
                discount: null,
                seller: 'ContentStrategist',
                likes: 450,
                isTopSeller: false,
                comments: [
                    { author: 'Community Manager', text: 'Indispensable pour la gestion de mes réseaux sociaux.' }
                ]
            },
            {
                id: 'product5',
                creatorId: 'user1',
                title: 'Séance de Coaching Marketing Personnalisé 1H',
                category: 'Coaching',
                categorySlug: 'coaching',
                description: 'Bénéficiez d\'une séance de coaching personnalisée d\'une heure pour discuter de votre stratégie marketing, résoudre vos défis spécifiques et obtenir des conseils d\'experts adaptés à votre entreprise.',
                image: 'https://raw.githubusercontent.com/balisama21/plateforme/main/coaching.jpg',
                price: 80000,
                oldPrice: null,
                discount: null,
                seller: 'Jean Dupont',
                likes: 320,
                isTopSeller: false,
                comments: [
                    { author: 'Client Satisfait', text: 'La séance a été très enrichissante et m\'a donné une nouvelle perspective.' }
                ]
            },
            {
                id: 'product6',
                creatorId: 'user2',
                title: '50 Modèles de Site Web Responsive (HTML/CSS)',
                category: 'Web Design',
                categorySlug: 'webdesign',
                description: 'Un ensemble de 50 modèles de sites web modernes et entièrement responsives, conçus avec HTML et CSS. Parfait pour les développeurs ou les agences souhaitant démarrer rapidement des projets professionnels.',
                image: 'https://placehold.co/600x400/98d698/ffffff?text=Modèles+Web',
                price: 30000,
                oldPrice: null,
                discount: null,
                seller: 'WebCrafters Mada',
                likes: 750,
                isTopSeller: false,
                comments: [
                    { author: 'Développeur Junior', text: 'Ces modèles sont un gain de temps incroyable. Très adaptables !' }
                ]
            },
            {
                id: 'product7',
                creatorId: 'user3',
                title: 'Outil de Gestion de Stock Simple pour PME',
                category: 'Outils',
                categorySlug: 'logistique',
                description: 'Un outil intuitif basé sur Excel (ou Google Sheets) pour les petites et moyennes entreprises. Suivez votre inventaire, gérez les entrées/sorties et optimisez vos stocks facilement.',
                image: 'https://placehold.co/600x400/add8e6/000000?text=Outil+Logistique',
                price: 20000,
                oldPrice: null,
                discount: null,
                seller: 'SolutionsEntreprise',
                likes: 300,
                isTopSeller: false,
                comments: [
                    { author: 'Gérant PME', text: 'Très pratique pour nos besoins basiques. Facile à prendre en main.' }
                ]
            }
        ];

        let currentProductId = null;

        const mobileMenu = document.querySelector('.mobile-menu');
        const mobileNav = document.querySelector('.mobile-nav');
        const searchInput = document.getElementById('searchInput');
        const searchBtn = document.querySelector('.search-btn');
        const clearSearchBtn = document.querySelector('.clear-search-btn');
        const productsGrid = document.getElementById('productsGridSection');
        const filtersSection = document.getElementById('filtersSection');
        const allSections = document.querySelectorAll('.main > section');
        const authModal = document.getElementById('authModal');
        const loginForm = document.getElementById('loginForm');
        const registerForm = document.getElementById('registerForm');
        const mainFooter = document.getElementById('mainFooter');

        // --- FUNCTIONS ---

        function toggleMobileMenu() {
            mobileMenu.classList.toggle('active');
            mobileNav.classList.toggle('active');
        }

        function showSection(sectionId) {
            allSections.forEach(section => section.classList.remove('active'));
            const sectionToShow = document.getElementById(sectionId);
            if (sectionToShow) sectionToShow.classList.add('active');

            const productsContainer = document.getElementById('productsContainer');
            const homeSection = document.getElementById('home');
            
            // Gestion de l'affichage du footer : seulement sur la page d'accueil
            if (sectionId === 'home' || sectionId === 'products') {
                if (sectionId === 'home') homeSection.classList.add('active');
                productsContainer.classList.add('active');
                filtersSection.classList.add('active');
                productsGrid.classList.add('active');
                mainFooter.style.display = 'block'; // Afficher le footer sur l'accueil
                resetSearch();
            } else {
                productsContainer.classList.remove('active');
                homeSection.classList.remove('active');
                mainFooter.style.display = 'none'; // Masquer le footer sur les autres pages
            }

            document.querySelectorAll('.nav-link, .mobile-nav-link').forEach(link => {
                link.classList.toggle('active', link.dataset.section === sectionId);
            });
            
            if (mobileNav.classList.contains('active')) toggleMobileMenu();
            window.scrollTo(0, 0);
        }

        function renderProductsGrid(productsToRender = products) {
            productsGrid.innerHTML = ''; 

            productsToRender.forEach(product => {
                const productCard = document.createElement('div');
                productCard.classList.add('product-card');
                productCard.dataset.id = product.id;
                productCard.dataset.category = product.categorySlug;
                productCard.dataset.isTopSeller = product.isTopSeller;
                productCard.dataset.keywords = `${product.title.toLowerCase()} ${product.category.toLowerCase()} ${product.seller.toLowerCase()}`;

                let badgeHtml = '';
                if (product.badge) { 
                    const badgeClass = product.badge === 'Nouveau' ? 'new-badge' : '';
                    badgeHtml = `<div class="product-badge ${badgeClass}">${product.badge}</div>`;
                } else if (product.discount) {
                    badgeHtml = `<div class="product-badge discount-badge">-${product.discount}%</div>`; 
                }
                
                const oldPriceHtml = product.oldPrice ? `<span class="old-price">${product.oldPrice.toLocaleString('fr-MG')} MGA</span>` : '';
                
                let ownerActionsHtml = '';
                if (authState.isLoggedIn && authState.currentUser.id === product.creatorId) {
                    ownerActionsHtml = `
                        <div class="product-owner-actions">
                            <button class="edit-btn" data-action="edit">Modifier</button>
                            <button class="delete-btn" data-action="delete">Supprimer</button>
                        </div>
                    `;
                }

                productCard.innerHTML = `
                    <div class="product-image ${product.categorySlug}">
                        <img src="${product.image}" alt="${product.title}" onerror="this.onerror=null;this.src='https://placehold.co/600x400/cccccc/333333?text=Image+non+disponible';">
                        ${badgeHtml}
                    </div>
                    <div class="product-info">
                        <div class="product-category">${product.category}</div>
                        <h3 class="product-title">${product.title}</h3>
                        <div class="product-rating">
                            <div class="stars">${'★'.repeat(Math.min(5, Math.round(product.likes / 500)) || 1)}</div>
                            <span class="rating-count">(${product.likes.toLocaleString('fr-MG')})</span>
                        </div>
                        <div class="product-price">
                            ${product.price.toLocaleString('fr-MG')} MGA
                            ${oldPriceHtml}
                        </div>
                        <div class="product-actions">
                            <button class="download-btn" data-action="download">Télécharger</button>
                            <button class="preview-btn" data-action="preview">Aperçu</button>
                        </div>
                        ${ownerActionsHtml} 
                    </div>
                `;
                productsGrid.appendChild(productCard);
            });
        }
        
        function updateAuthUI() {
            const authLinks = document.getElementById('auth-links');
            const userProfile = document.getElementById('user-profile');
            const usernameDisplay = document.getElementById('username-display');
            
            if (!authLinks || !userProfile || !usernameDisplay) return;
            
            if (authState.isLoggedIn && authState.currentUser) {
                // Afficher le profil utilisateur, masquer les liens d'auth
                authLinks.style.display = 'none';
                userProfile.style.display = 'block';
                usernameDisplay.textContent = authState.currentUser.name;
                
                // Mettre à jour les informations du dropdown
                const userDropdownName = document.getElementById('userDropdownName');
                const userDropdownEmail = document.getElementById('userDropdownEmail');
                if (userDropdownName) userDropdownName.textContent = authState.currentUser.name;
                if (userDropdownEmail) userDropdownEmail.textContent = authState.currentUser.email;
                
                // Configurer le bouton menu utilisateur
                const userMenuBtn = document.getElementById('userMenuBtn');
                const userDropdown = document.getElementById('userDropdown');
                
                if (userMenuBtn && userDropdown) {
                    // Supprimer les anciens event listeners
                    userMenuBtn.onclick = null;
                    
                    // Nouveau event listener
                    userMenuBtn.addEventListener('click', function(e) {
                        e.preventDefault();
                        e.stopPropagation();
                        userDropdown.classList.toggle('active');
                    });
                }
                
            } else {
                // Afficher les liens d'auth, masquer le profil
                authLinks.style.display = 'block';
                userProfile.style.display = 'none';
                usernameDisplay.textContent = '';
                
                // S'assurer que le dropdown est fermé
                const userDropdown = document.getElementById('userDropdown');
                if (userDropdown) {
                    userDropdown.classList.remove('active');
                }
            }
            
            renderProductsGrid();
        }

        function showAuthModal(formToShow = 'login') {
            if (formToShow === 'login') {
                loginForm.style.display = 'block';
                registerForm.style.display = 'none';
            } else {
                loginForm.style.display = 'none';
                registerForm.style.display = 'block';
            }
            authModal.style.display = 'block';
        }
        
        function closeAuthModal() {
            authModal.style.display = 'none';
        }
        
        function handleLogin(email, password) {
            const user = users.find(u => u.email === email && u.password === password);
            if (user) {
                authState.isLoggedIn = true;
                authState.currentUser = user;
                alert(`Bienvenue ${user.name} !`);
                closeAuthModal();
                updateAuthUI();
            } else {
                alert('Email ou mot de passe incorrect.');
            }
        }
        
        function handleRegister(firstName, lastName, email, phone, password, confirmPassword) {
            if (password !== confirmPassword) {
                alert('Les mots de passe ne correspondent pas.');
                return;
            }
            if (users.find(u => u.email === email)) {
                alert('Cet email est déjà utilisé.');
                return;
            }
            const fullName = `${firstName} ${lastName}`;
            const newUser = { id: 'user' + (users.length + 1), name: fullName, email, phone, password };
            users.push(newUser);
            authState.isLoggedIn = true;
            authState.currentUser = newUser;
            alert(`Inscription réussie ! Bienvenue ${fullName}.`);
            closeAuthModal();
            updateAuthUI();
        }

        // Fonction pour toggle la visibilité du mot de passe
        function togglePassword(inputId) {
            const input = document.getElementById(inputId);
            const button = input.nextElementSibling;
            if (input.type === 'password') {
                input.type = 'text';
                button.textContent = '🙈';
            } else {
                input.type = 'password';
                button.textContent = '👁️';
            }
        }

        // Rendre la fonction globale pour l'onclick
        window.togglePassword = togglePassword;

        function handleLogout() {
            authState.isLoggedIn = false;
            authState.currentUser = null;
            alert('Vous avez été déconnecté.');
            updateAuthUI();
            showSection('home');
        }
        
        function requireAuth(callback) {
            if (authState.isLoggedIn) {
                callback();
            } else {
                alert("Vous devez être connecté pour effectuer cette action.");
                showAuthModal('login');
            }
        }

        function performSearch() {
            const searchTerm = searchInput.value.toLowerCase().trim();
            const searchResultsDiv = document.getElementById('searchResults');
            const searchResultsText = document.getElementById('searchResultsText');
            const searchResultsCount = document.getElementById('searchResultsCount');
            const noResultsDiv = document.getElementById('noResults');
            const loadingSpinner = document.getElementById('loadingSpinner');

            loadingSpinner.style.display = 'block';
            productsGrid.classList.remove('active');
            searchResultsDiv.classList.remove('active');
            noResultsDiv.classList.remove('active');

            setTimeout(() => { 
                loadingSpinner.style.display = 'none';
                productsGrid.classList.add('active');

                const filteredProducts = products.filter(p => {
                    const keywords = `${p.title.toLowerCase()} ${p.category.toLowerCase()} ${p.seller.toLowerCase()}`;
                    return keywords.includes(searchTerm);
                });

                renderProductsGrid(filteredProducts);
                
                if (searchTerm !== '') {
                    if (filteredProducts.length > 0) {
                        searchResultsDiv.classList.add('active');
                        searchResultsText.innerText = `Résultats de recherche pour "${searchTerm}"`;
                        searchResultsCount.innerText = `${filteredProducts.length} produit(s) trouvé(s).`;
                        noResultsDiv.classList.remove('active');
                    } else {
                        noResultsDiv.classList.add('active');
                        searchResultsDiv.classList.remove('active');
                    }
                } else {
                    resetSearch();
                }
            }, 500);
        }

        function resetSearch() {
            searchInput.value = '';
            document.getElementById('searchResults').classList.remove('active');
            document.getElementById('noResults').classList.remove('active');
            filterProducts('all');
        }

        function filterProducts(filter) {
            const filterBtns = document.querySelectorAll('.filter-btn');
            filterBtns.forEach(btn => btn.classList.remove('active'));
            document.querySelector(`.filter-btn[data-filter="${filter}"]`).classList.add('active');
            
            let filteredProducts;
            if (filter === 'all') {
                filteredProducts = products;
            } else if (filter === 'top-seller') {
                filteredProducts = products.filter(p => p.isTopSeller);
            } else {
                filteredProducts = products.filter(p => p.categorySlug === filter);
            }
            renderProductsGrid(filteredProducts);

            document.getElementById('searchResults').classList.remove('active');
            document.getElementById('noResults').classList.remove('active');
            searchInput.value = '';
        }

        function showProductDetail(productId) {
            const product = products.find(p => p.id === productId);
            if (!product) return;

            currentProductId = productId;

            document.getElementById('detailProductTitle').innerText = product.title;
            document.getElementById('detailProductCategory').innerText = product.category;
            document.getElementById('detailProductSeller').innerText = product.seller;
            document.getElementById('detailProductPrice').innerText = `${product.price.toLocaleString('fr-MG')} MGA`;
            document.getElementById('detailProductDescription').innerText = product.description;
            document.getElementById('likeCount').innerText = product.likes.toLocaleString();

            const detailImageContainer = document.getElementById('detailProductImage');
            detailImageContainer.innerHTML = `<img src="${product.image}" alt="${product.title}">`;

            renderCommentsForProduct(product);
            showSection('productDetail');
        }

        function renderCommentsForProduct(product) {
            const commentsList = document.getElementById('commentsList');
            commentsList.innerHTML = '';
            if (product.comments && product.comments.length > 0) {
                product.comments.forEach(comment => {
                    const commentItem = document.createElement('div');
                    commentItem.classList.add('comment-item');
                    commentItem.innerHTML = `<p class="comment-author">${comment.author}</p><p class="comment-text">${comment.text}</p>`;
                    commentsList.appendChild(commentItem);
                });
                document.getElementById('commentCount').innerText = product.comments.length;
            } else {
                commentsList.innerHTML = '<p style="text-align: center; color: #666;">Aucun commentaire pour le moment.</p>';
                document.getElementById('commentCount').innerText = '0';
            }
        }
        
        function handleEditProduct(productId) {
            const product = products.find(p => p.id === productId);
            if (!product) return;

            document.getElementById('editingProductId').value = product.id;
            document.getElementById('productTitle').value = product.title;
            document.getElementById('productCategory').value = product.categorySlug;
            document.getElementById('productDescription').value = product.description;
            document.getElementById('productPrice').value = product.price;

            document.querySelector('#sellProductForm .form-title').textContent = "Modifier le produit";
            document.querySelector('#sellProductForm .form-submit-btn').textContent = "Mettre à jour";

            showSection('sellProductForm');
        }
        
        function handleDeleteProduct(productId) {
             if (confirm("Êtes-vous sûr de vouloir supprimer ce produit ? Cette action est irréversible.")) {
                const productIndex = products.findIndex(p => p.id === productId);
                if (productIndex > -1) {
                    products.splice(productIndex, 1);
                    alert("Produit supprimé avec succès.");
                    showSection('home');
                }
            }
        }

        // --- EVENT LISTENERS ---

        document.addEventListener('DOMContentLoaded', () => {
            renderProductsGrid();
            showSection('home');
            updateAuthUI();
        });
        
        document.querySelectorAll('.nav-link, .mobile-nav-link, .footer-section a[data-section]').forEach(link => {
            link.addEventListener('click', (e) => {
                e.preventDefault();
                const sectionId = link.dataset.section;
                if(sectionId) showSection(sectionId);
            });
        });

        mobileMenu.addEventListener('click', toggleMobileMenu);
        document.querySelector('.mobile-nav-close').addEventListener('click', toggleMobileMenu);
        
        searchBtn.addEventListener('click', performSearch);
        searchInput.addEventListener('keyup', (e) => {
            if (e.key === 'Enter') performSearch();
        });
        clearSearchBtn.addEventListener('click', resetSearch);

        filtersSection.addEventListener('click', (e) => {
            if (e.target.classList.contains('filter-btn')) {
                filterProducts(e.target.dataset.filter);
            }
        });
        
        productsGrid.addEventListener('click', (e) => {
            const card = e.target.closest('.product-card');
            if (!card) return;

            const action = e.target.dataset.action;
            const productId = card.dataset.id;
            
            if (action === 'download') {
                requireAuth(() => showSection('downloadForm'));
            } else if (action === 'preview') {
                showProductDetail(productId);
            } else if (action === 'edit') {
                 handleEditProduct(productId);
            } else if (action === 'delete') {
                 handleDeleteProduct(productId);
            } else { 
                showProductDetail(productId);
            }
        });

        document.getElementById('productPublishForm').addEventListener('submit', function(event) {
            event.preventDefault();
            
            const editingId = document.getElementById('editingProductId').value;
            
            if (editingId) {
                const productIndex = products.findIndex(p => p.id === editingId);
                if (productIndex > -1) {
                    products[productIndex].title = this.querySelector('#productTitle').value;
                    products[productIndex].category = this.querySelector('#productCategory').options[this.querySelector('#productCategory').selectedIndex].text;
                    products[productIndex].categorySlug = this.querySelector('#productCategory').value;
                    products[productIndex].description = this.querySelector('#productDescription').value;
                    products[productIndex].price = parseFloat(this.querySelector('#productPrice').value);
                    
                    const imageFile = this.querySelector('#productFile').files[0];
                    if (imageFile) {
                        products[productIndex].image = URL.createObjectURL(imageFile);
                    }
                    alert('Produit mis à jour !');
                }
            } else {
                const newProduct = {
                    id: 'product' + (products.length + 1),
                    creatorId: authState.currentUser.id,
                    title: this.querySelector('#productTitle').value,
                    category: this.querySelector('#productCategory').options[this.querySelector('#productCategory').selectedIndex].text,
                    categorySlug: this.querySelector('#productCategory').value,
                    description: this.querySelector('#productDescription').value,
                    image: 'https://placehold.co/600x400/cccccc/333333?text=Nouveau+Produit',
                    price: parseFloat(this.querySelector('#productPrice').value),
                    seller: authState.currentUser.name,
                    likes: 0,
                    comments: [],
                    badge: 'Nouveau',
                    isTopSeller: false
                };
                
                const imageFile = this.querySelector('#productFile').files[0];
                if (imageFile) {
                    newProduct.image = URL.createObjectURL(imageFile);
                }

                products.unshift(newProduct);
                alert('Votre produit a été soumis !');
            }
            
            this.reset();
            document.getElementById('editingProductId').value = '';
            document.querySelector('#sellProductForm .form-title').textContent = "Proposer un nouveau produit ou service";
            document.querySelector('#sellProductForm .form-submit-btn').textContent = "Soumettre le produit";

            showSection('home');
        });
        
        document.getElementById('downloadInfoForm').addEventListener('submit', function(e){
            e.preventDefault();
            alert('Merci ! Votre téléchargement va commencer.');
            this.reset();
            showSection('home');
        });

        document.querySelector('.newsletter-form').addEventListener('submit', function(e) {
            e.preventDefault();
            alert('Merci pour votre abonnement !');
            this.reset();
        });
        
        document.getElementById('detailLikeBtn').addEventListener('click', () => {
            requireAuth(() => {
                const product = products.find(p => p.id === currentProductId);
                if (product) {
                    product.likes++;
                    document.getElementById('likeCount').innerText = product.likes.toLocaleString();
                    renderProductsGrid();
                }
            });
        });
        
        document.getElementById('submitCommentBtn').addEventListener('click', () => {
            requireAuth(() => {
                const newCommentTextarea = document.getElementById('newCommentText');
                const newCommentContent = newCommentTextarea.value.trim();
                if (newCommentContent === '' || !currentProductId) return;

                const product = products.find(p => p.id === currentProductId);
                if (product) {
                    const newComment = { author: authState.currentUser.name, text: newCommentContent }; 
                    product.comments.push(newComment);
                    renderCommentsForProduct(product);
                    newCommentTextarea.value = '';
                }
            });
        });
        
        document.getElementById('detailDownloadBtn').addEventListener('click', () => requireAuth(() => showSection('downloadForm')));
        
        // --- EVENT LISTENERS POUR AUTHENTIFICATION ---
        document.addEventListener('click', (e) => {
            const action = e.target.dataset.action;
            const isInHeaderActions = e.target.closest('.header-actions');
            
            if (isInHeaderActions && action) {
                if (action === 'show-auth') {
                    e.preventDefault();
                    showAuthModal('login');
                } else if (action === 'logout') {
                    e.preventDefault();
                    const userDropdown = document.getElementById('userDropdown');
                    if (userDropdown) userDropdown.classList.remove('active');
                    handleLogout();
                } else if (action === 'sell') {
                    e.preventDefault();
                    requireAuth(() => showSection('sellProductForm'));
                } else if (action === 'profile') {
                    e.preventDefault();
                    alert('Fonctionnalité "Mon profil" à venir');
                    const userDropdown = document.getElementById('userDropdown');
                    if (userDropdown) userDropdown.classList.remove('active');
                } else if (action === 'orders') {
                    e.preventDefault();
                    alert('Fonctionnalité "Mes commandes" à venir');
                    const userDropdown = document.getElementById('userDropdown');
                    if (userDropdown) userDropdown.classList.remove('active');
                } else if (action === 'products') {
                    e.preventDefault();
                    alert('Fonctionnalité "Mes produits" à venir');
                    const userDropdown = document.getElementById('userDropdown');
                    if (userDropdown) userDropdown.classList.remove('active');
                }
            }
        });
        
        document.querySelector('.mobile-nav-container').addEventListener('click', (e) => {
            if (e.target.dataset.action === 'sell') {
                e.preventDefault();
                requireAuth(() => showSection('sellProductForm'));
            }
        });
        
        authModal.addEventListener('click', (e) => {
            if (e.target.classList.contains('auth-modal') || e.target.classList.contains('close-btn')) {
                closeAuthModal();
            }
            const action = e.target.dataset.action;
            if (action === 'show-register') {
                e.preventDefault();
                showAuthModal('register');
            } else if (action === 'show-login') {
                e.preventDefault();
                showAuthModal('login');
            }
        });

        document.getElementById('loginForm').addEventListener('submit', (e) => {
            e.preventDefault();
            const email = document.getElementById('loginEmail').value;
            const password = document.getElementById('loginPassword').value;
            handleLogin(email, password);
        });

        document.getElementById('registerForm').addEventListener('submit', (e) => {
            e.preventDefault();
            const firstName = document.getElementById('registerFirstName').value;
            const lastName = document.getElementById('registerLastName').value;
            const email = document.getElementById('registerEmail').value;
            const phone = document.getElementById('registerPhone').value;
            const password = document.getElementById('registerPassword').value;
            const confirmPassword = document.getElementById('confirmPassword').value;
            const acceptTerms = document.getElementById('acceptTerms').checked;
            
            if (!acceptTerms) {
                alert('Vous devez accepter les conditions d\'utilisation pour continuer.');
                return;
            }
            
            handleRegister(firstName, lastName, email, phone, password, confirmPassword);
        });

        // Fermer le menu mobile en cliquant à l'extérieur
        document.addEventListener('click', (e) => {
            if (mobileNav.classList.contains('active') && 
                !mobileNav.contains(e.target) && 
                !mobileMenu.contains(e.target)) {
                toggleMobileMenu();
            }
        });

    </script>
</body>
</html>
